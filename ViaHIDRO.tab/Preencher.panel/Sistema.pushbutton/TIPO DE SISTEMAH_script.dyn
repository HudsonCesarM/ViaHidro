{
  "Uuid": "cbe26318-2308-453d-b8a1-35a528bdf381",
  "IsCustomNode": false,
  "Description": "",
  "Name": "TIPO DE SISTEMAH_script",
  "ElementResolver": {
    "ResolutionMap": {}
  },
  "Inputs": [],
  "Outputs": [],
  "Nodes": [
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(350, 200)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label e o campo de entrada de texto.\"\"\"\r\n        lbl = Label()\r\n        lbl.Text = \"Digite o texto:\"\r\n        lbl.Location = Point(20, 20)\r\n        lbl.Size = Size(150, 30)\r\n        self.Controls.Add(lbl)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 50)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 90)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        self.user_input = self.txt_input.Text\r\n        self.Close()\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto inserido pelo usuário será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "eed387aad76b45adbcde7db4be1589bd",
      "Inputs": [
        {
          "Id": "cd3a959d411947619874ff4ae9a2c99f",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "6d9638a2b6294b76982261f187dcaba1",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitAPIUI')\r\n\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\nfrom Autodesk.Revit.DB import Element\r\n\r\n# Obter o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obter os elementos selecionados a partir de IN[0] e o texto da IN[1]\r\nelements = UnwrapElement(IN[0])  # Desembrulha os elementos do Dynamo\r\ntext_to_set = IN[1]  # Texto a ser inserido no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\n\r\n# Iniciar uma transação para modificar os parâmetros no Revit\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n\r\n# Iterar sobre os elementos e definir o valor no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\nfor element in elements:\r\n    marca_param = element.LookupParameter(\"ORÇAMENTO TIPO DE SISTEMA\")\r\n    if marca_param and not marca_param.IsReadOnly:\r\n        marca_param.Set(text_to_set)\r\n\r\n# Finalizar a transação\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\n# Saída\r\nOUT = \"Texto atualizado no parâmetro 'ORÇAMENTO TIPO DE SISTEMA' para {} elementos.\".format(len(elements))\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "499628238e654e7295272e757a058a3a",
      "Inputs": [
        {
          "Id": "44d7424967db4458a973a1bf53e169f7",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "e32677c97c1c47e09f81e51f3f124f1b",
          "Name": "IN[1]",
          "Description": "Input #1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "f0fe0c8ffa324548b1212ab8ce06eced",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "# Importando bibliotecas necessárias\r\nimport clr\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitServices')\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom Autodesk.Revit.DB import ElementId, FilteredElementCollector\r\n\r\n# Obtendo o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Função para obter elementos filhos\r\ndef get_child_elements(element):\r\n    child_elements = []\r\n    \r\n    # Coletor para buscar elementos\r\n    collector = FilteredElementCollector(doc).WhereElementIsNotElementType()\r\n    \r\n    for el in collector:\r\n        # Verifica se o elemento é filho do elemento pai (ajuste conforme a lógica necessária)\r\n        if el.GetType() == element.GetType() and el.OwnerViewId == element.OwnerViewId:\r\n            child_elements.append(el)\r\n    \r\n    return child_elements\r\n\r\n# Processando a entrada (lista de elementos)\r\ninput_elements = UnwrapElement(IN[0])  # IN[0] é a entrada da lista de elementos\r\nall_child_elements = []\r\n\r\nfor elem in input_elements:\r\n    children = get_child_elements(elem)\r\n    all_child_elements.extend(children)  # Adiciona os filhos à lista principal\r\n\r\n# Saída: lista única de todos os elementos filhos\r\nOUT = all_child_elements\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "a03091fc7cfa4ed1a20db2c0357a8153",
      "Inputs": [
        {
          "Id": "0a76876967874e839e587d2272953ff2",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "9bbafb9ea3ce4477a803964445ec38bb",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(350, 400)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.error_label = None  # Inicializando a variável para o erro\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label com as opções e o campo de entrada de texto.\"\"\"\r\n        lbl_options = Label()\r\n        lbl_options.Text = (\r\n            \"\\nEscolha uma opção:\\n\\n\"\r\n            \"1 - AUTOMACAO\\n2 - CABEAMENTO ESTRUTURADO\\n3 - CFTV\\n4 - COMUNICACAO VISUAL\\n\"\r\n            \"5 - DRENAGEM PLUVIAL\\n6 - ELETRICO\\n7 - EST. CONCRETO\\n8 - EST. METALICA\\n\"\r\n            \"9 - GASES MEDICINAIS\\n10 - GLP\\n11 - HIDROSSANITARIO\\n12 - INCENDIO\\n\"\r\n            \"13 - LUMINOTECNICO\\n14 - SDAI\\n15 - SPDA\"\r\n        )\r\n        lbl_options.Location = Point(20, 20)\r\n        lbl_options.Size = Size(300, 220)\r\n        lbl_options.AutoSize = True\r\n        self.Controls.Add(lbl_options)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 250)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 300)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        options = {\r\n            1: \"AUTOMACAO\",\r\n            2: \"CABEAMENTO ESTRUTURADO\",\r\n            3: \"CFTV\",\r\n            4: \"COMUNICACAO VISUAL\",\r\n            5: \"DRENAGEM PLUVIAL\",\r\n            6: \"ELETRICO\",\r\n            7: \"EST. CONCRETO\",\r\n            8: \"EST. METALICA\",\r\n            9: \"GASES MEDICINAIS\",\r\n            10: \"GLP\",\r\n            11: \"HIDROSSANITARIO\",\r\n            12: \"INCENDIO\",\r\n            13: \"LUMINOTECNICO\",\r\n            14: \"SDAI\",\r\n            15: \"SPDA\"\r\n        }\r\n\r\n        try:\r\n            # Remove a mensagem de erro anterior, se existir\r\n            if self.error_label:\r\n                self.Controls.Remove(self.error_label)\r\n\r\n            input_value = int(self.txt_input.Text)\r\n            if input_value in options:\r\n                self.user_input = options[input_value]\r\n            else:\r\n                self.user_input = None\r\n                self.show_error(\"Por favor, escolha uma opção válida (1-15).\")\r\n        except ValueError:\r\n            self.user_input = None\r\n            self.show_error(\"Por favor, insira um número válido.\")\r\n\r\n        if self.user_input is not None:\r\n            self.Close()\r\n\r\n    def show_error(self, message):\r\n        \"\"\"Exibe uma mensagem de erro.\"\"\"\r\n        self.error_label = Label()\r\n        self.error_label.Text = message\r\n        self.error_label.Location = Point(20, 340)\r\n        self.error_label.Size = Size(300, 30)\r\n        self.error_label.ForeColor = Color.Red\r\n        self.Controls.Add(self.error_label)\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto correspondente à opção escolhida será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "ba0dba6294e84eebad133dd870a51acd",
      "Inputs": [
        {
          "Id": "9b68c20305794642a42136624ca92d4b",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "6f80c559d8a14db0afbb440437ab7c00",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "Revit.Elements.Element.GetChildElements",
      "Id": "f19c41c1ab1a456b97046a740ad6c843",
      "Inputs": [
        {
          "Id": "f078435f0a724f78b5c62291dd5d621b",
          "Name": "element",
          "Description": "Revit.Elements.Element",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "4bff9b097fe342b28ceb5b64e6a74e97",
          "Name": "Element[]",
          "Description": "Elementos secundários.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Longest",
      "Description": "Obtém os elementos secundários do elemento atual.\n\nElement.GetChildElements ( ): Element[]"
    },
    {
      "ConcreteType": "CoreNodeModels.CreateList, CoreNodeModels",
      "VariableInputPorts": true,
      "NodeType": "ExtensionNode",
      "Id": "36f3a5371d6446fabfe32483ed043c6d",
      "Inputs": [
        {
          "Id": "f985f7c0aea04532a77187aef1f57926",
          "Name": "item0",
          "Description": "Índice do item nº 0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "1460db53475148cc821b476055eb3231",
          "Name": "item1",
          "Description": "Índice do Item nº 1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "859ba656cab84e78955ecb21f175d0b8",
          "Name": "list",
          "Description": "Uma lista (tipo: var[]..[])",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Cria uma nova saída da lista das entradas determinadas"
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.List.Flatten@var[]..[],int",
      "Id": "d537674ddf11492296d5f32255e94334",
      "Inputs": [
        {
          "Id": "68ca7090cccb4d3ebed9727d176d718c",
          "Name": "list",
          "Description": "Lista para aplainar.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "092e3fa3899a4a6fa814190eeb526fbc",
          "Name": "amount",
          "Description": "Camadas de aninhamento de listas a serem removidas (-1 removerá todos os aninhamentos de listas)\n\nint\nValor padrão : -1",
          "UsingDefaultValue": true,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "c729917f78ce4d4aa11e38b16b6dfed1",
          "Name": "list",
          "Description": "Lista nivelada por quantidade",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Aplaina uma lista aninhada de listas por um determinado montante.\n\nList.Flatten (list: var[]..[], amount: int = -1): var[]..[]"
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.Object.IsNull@var",
      "Id": "05909d0aae28499bbc6e072e0f67db03",
      "Inputs": [
        {
          "Id": "1d4f31e99c83431da71f560c95dd7605",
          "Name": "object",
          "Description": "O objeto para testar.\n\nvar",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "7e7bb640c7a74fc7938cf5943284294e",
          "Name": "bool",
          "Description": "Se o objeto for nulo.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Determina se o objeto especificado é nulo.\n\nObject.IsNull (object: var): bool"
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.List.FilterByBoolMask@var[]..[],var[]..[]",
      "Id": "8a80f2a779584a0982412abc50372592",
      "Inputs": [
        {
          "Id": "0623b13038a54454b2314050277714a2",
          "Name": "list",
          "Description": "Lista a filtrar.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "7671e771694d4ae2b6b0e863dabcf6d5",
          "Name": "mask",
          "Description": "Lista de booleanos representando uma máscara.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "a1ab8777a93840cd91cb349f33338763",
          "Name": "in",
          "Description": "Os itens cujo índice de máscara é verdadeiro.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "bbb3f6ad9b5e4c2a8f925b1ce124f172",
          "Name": "out",
          "Description": "Os itens cujo índice de máscara é falso.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Filtra uma sequência examinando os índices correspondentes em lista separada de booleanos.\n\nList.FilterByBoolMask (list: var[]..[], mask: var[]..[]): var[]..[]"
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "#TEMPLATE Python Script by BIM Coder\r\n#Versão 1.0 - 08/24\r\n\r\n#---IMPORTAÇÕES\r\n# Sistema e .NET\r\nimport clr\r\nimport sys\r\nimport System\r\nfrom System import Array\r\nfrom System.Collections.Generic import *\r\n\r\n# Biblioteca de Geometria do Dynamo\r\nclr.AddReference('ProtoGeometry')\r\nfrom Autodesk.DesignScript.Geometry import *\r\n\r\n# Nós do Dynamo\r\nclr.AddReference('RevitNodes')\r\nimport Revit\r\nclr.ImportExtensions(Revit.Elements)\r\nclr.ImportExtensions(Revit.GeometryConversion)\r\n\r\n# Documentos e Transações\r\nclr.AddReference('RevitServices')\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n# DB da API do Revit\r\nimport Autodesk\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Interface do usuário da API do Revit\r\nclr.AddReference('RevitAPIUI')\r\nfrom Autodesk.Revit.UI import *\r\n\r\nfrom Autodesk.Revit.UI.Selection import ObjectType\r\n\r\n# Documentos e Interfaces\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\nuiapp = DocumentManager.Instance.CurrentUIApplication\r\napp = uiapp.Application\r\nuidoc = uiapp.ActiveUIDocument\r\n\r\n#---CLASSES E FUNÇÕES\r\n\r\n#---SCRIPT\r\n\r\n# Solicitar ao usuário que selecione múltiplos objetos do tipo Element (por exemplo, paredes, janelas, etc.)\r\n\r\nselected_references = uidoc.Selection.PickObjects(ObjectType.Element)\r\n\r\n# Obter os elementos a partir das referências\r\nselected_elements = [uidoc.Document.GetElement(reference) for reference in selected_references]\r\n\r\n# Saída para o Dynamo (lista de elementos Revit)\r\nOUT = selected_elements\r\n\r\n\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "1804c1ab9eb44617b7e31e9346c64cf8",
      "Inputs": [
        {
          "Id": "d718b7b6ea7d40afb9a324d24c8530ac",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "badef45b55b74bb6bd320f2129df1acd",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.List.Flatten@var[]..[],int",
      "Id": "d2ab14e2a7604ec1975c6d36d5a08330",
      "Inputs": [
        {
          "Id": "5920796a09bc4e1baffec63d78e89a6e",
          "Name": "list",
          "Description": "Lista para aplainar.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "e1b112fc42274359b671bca576ddd770",
          "Name": "amount",
          "Description": "Camadas de aninhamento de listas a serem removidas (-1 removerá todos os aninhamentos de listas)\n\nint\nValor padrão : -1",
          "UsingDefaultValue": true,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "3f2d8c10eae04060b8a38ae50f89d7b1",
          "Name": "list",
          "Description": "Lista nivelada por quantidade",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Aplaina uma lista aninhada de listas por um determinado montante.\n\nList.Flatten (list: var[]..[], amount: int = -1): var[]..[]"
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.Object.IsNull@var",
      "Id": "876c460d8e4c496b9dcf1bc73d3f362c",
      "Inputs": [
        {
          "Id": "50ae05641394474e889a8d6e670cc603",
          "Name": "object",
          "Description": "O objeto para testar.\n\nvar",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "327b32b1da344a669f8d0bf63fcf0b15",
          "Name": "bool",
          "Description": "Se o objeto for nulo.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Determina se o objeto especificado é nulo.\n\nObject.IsNull (object: var): bool"
    },
    {
      "ConcreteType": "Dynamo.Graph.Nodes.ZeroTouch.DSFunction, DynamoCore",
      "NodeType": "FunctionNode",
      "FunctionSignature": "DSCore.List.FilterByBoolMask@var[]..[],var[]..[]",
      "Id": "a3dcddeaf4914af9b1ffb707ac7e054c",
      "Inputs": [
        {
          "Id": "f7a46fe9b92e4a82bcfc6f69658040dd",
          "Name": "list",
          "Description": "Lista a filtrar.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "24f67f2236b84ad9b461c73e75d67382",
          "Name": "mask",
          "Description": "Lista de booleanos representando uma máscara.\n\nvar[]..[]",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "a0265fe57f8c4f1db90f94cd257abe5c",
          "Name": "in",
          "Description": "Os itens cujo índice de máscara é verdadeiro.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "58fac792c0794d1cbef26eb498a419ab",
          "Name": "out",
          "Description": "Os itens cujo índice de máscara é falso.",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Auto",
      "Description": "Filtra uma sequência examinando os índices correspondentes em lista separada de booleanos.\n\nList.FilterByBoolMask (list: var[]..[], mask: var[]..[]): var[]..[]"
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nfrom RevitServices.Persistence import DocumentManager\r\n\r\nclr.AddReference(\"RevitAPI\")\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Função para listar os elementos principais e suas famílias aninhadas\r\ndef get_all_elements(element, collected_ids):\r\n    element_list = []\r\n    if isinstance(element, FamilyInstance):\r\n        # Adicionar o elemento principal à lista, se ainda não foi adicionado\r\n        if element.Id not in collected_ids:\r\n            element_list.append(element)\r\n            collected_ids.add(element.Id)\r\n        \r\n        # Verificar se o elemento tem famílias aninhadas\r\n        sub_elements = element.GetSubComponentIds()\r\n        \r\n        # Se o elemento não tiver subcomponentes, garantir que seja adicionado\r\n        if not sub_elements:\r\n            return element_list\r\n        \r\n        # Se tiver subcomponentes, adicionar os aninhados\r\n        for sub_elem_id in sub_elements:\r\n            sub_elem = doc.GetElement(sub_elem_id)\r\n            if isinstance(sub_elem, FamilyInstance) and sub_elem.Id not in collected_ids:\r\n                element_list.append(sub_elem)\r\n                collected_ids.add(sub_elem.Id)\r\n                # Recursivamente buscar subcomponentes dos aninhados\r\n                element_list.extend(get_all_elements(sub_elem, collected_ids))\r\n    \r\n    return element_list\r\n\r\n# Coletando o documento ativo\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Entrada 0 - elementos selecionados\r\ninput_elements = UnwrapElement(IN[0])\r\n\r\n# Inicializando a lista de todos os elementos (principais e aninhados)\r\nall_elements = []\r\n\r\n# Inicializando um conjunto para evitar duplicatas com base no ID dos elementos\r\ncollected_ids = set()\r\n\r\n# Verificando todos os elementos e suas famílias aninhadas\r\nfor element in input_elements:\r\n    all_elements.extend(get_all_elements(element, collected_ids))\r\n\r\n# Saída - lista de todos os elementos, incluindo principais e aninhados\r\nOUT = all_elements\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "26d28fee827249d79275f3b82425a052",
      "Inputs": [
        {
          "Id": "1d580ead64394ff8be9275b0f755b71b",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "65ae40241eeb4a998e2cea11c9f4e390",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitAPIUI')\r\n\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\nfrom Autodesk.Revit.DB import Element\r\n\r\n# Obter o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obter os elementos selecionados a partir de IN[0] e o texto da IN[1]\r\nelements = UnwrapElement(IN[0])  # Desembrulha os elementos do Dynamo\r\ntext_to_set = IN[1]  # Texto a ser inserido no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\n\r\n# Iniciar uma transação para modificar os parâmetros no Revit\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n\r\n# Iterar sobre os elementos e definir o valor no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\nfor element in elements:\r\n    marca_param = element.LookupParameter(\"ORÇAMENTO TIPO DE SISTEMA\")\r\n    if marca_param and not marca_param.IsReadOnly:\r\n        marca_param.Set(text_to_set)\r\n\r\n# Finalizar a transação\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\n# Saída\r\nOUT = \"Texto atualizado no parâmetro 'ORÇAMENTO TIPO DE SISTEMA' para {} elementos.\".format(len(elements))\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "1a7e7dc827e24ea19ad11078517ee2be",
      "Inputs": [
        {
          "Id": "049c101829244e05843d0b2d61749aad",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "cea620087db6496597303dd418ad0822",
          "Name": "IN[1]",
          "Description": "Input #1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "33fb1a2e212f4487bb6128f84cb759ac",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(350, 400)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.error_label = None  # Inicializando a variável para o erro\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label com as opções e o campo de entrada de texto.\"\"\"\r\n        lbl_options = Label()\r\n        lbl_options.Text = (\r\n            \"\\nEscolha uma opção:\\n\\n\"\r\n            \"1 - AUTOMACAO\\n2 - CABEAMENTO ESTRUTURADO\\n3 - CFTV\\n4 - COMUNICACAO VISUAL\\n\"\r\n            \"5 - DRENAGEM PLUVIAL\\n6 - ELETRICO\\n7 - EST. CONCRETO\\n8 - EST. METALICA\\n\"\r\n            \"9 - GASES MEDICINAIS\\n10 - GLP\\n11 - HIDROSSANITARIO\\n12 - INCENDIO\\n\"\r\n            \"13 - LUMINOTECNICO\\n14 - SDAI\\n15 - SPDA\"\r\n        )\r\n        lbl_options.Location = Point(20, 20)\r\n        lbl_options.Size = Size(300, 220)\r\n        lbl_options.AutoSize = True\r\n        self.Controls.Add(lbl_options)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 250)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 300)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        options = {\r\n            1: \"AUTOMACAO\",\r\n            2: \"CABEAMENTO ESTRUTURADO\",\r\n            3: \"CFTV\",\r\n            4: \"COMUNICACAO VISUAL\",\r\n            5: \"DRENAGEM PLUVIAL\",\r\n            6: \"ELETRICO\",\r\n            7: \"EST. CONCRETO\",\r\n            8: \"EST. METALICA\",\r\n            9: \"GASES MEDICINAIS\",\r\n            10: \"GLP\",\r\n            11: \"HIDROSSANITARIO\",\r\n            12: \"INCENDIO\",\r\n            13: \"LUMINOTECNICO\",\r\n            14: \"SDAI\",\r\n            15: \"SPDA\"\r\n        }\r\n\r\n        try:\r\n            # Remove a mensagem de erro anterior, se existir\r\n            if self.error_label:\r\n                self.Controls.Remove(self.error_label)\r\n\r\n            input_value = int(self.txt_input.Text)\r\n            if input_value in options:\r\n                self.user_input = options[input_value]\r\n            else:\r\n                self.user_input = None\r\n                self.show_error(\"Por favor, escolha uma opção válida (1-15).\")\r\n        except ValueError:\r\n            self.user_input = None\r\n            self.show_error(\"Por favor, insira um número válido.\")\r\n\r\n        if self.user_input is not None:\r\n            self.Close()\r\n\r\n    def show_error(self, message):\r\n        \"\"\"Exibe uma mensagem de erro.\"\"\"\r\n        self.error_label = Label()\r\n        self.error_label.Text = message\r\n        self.error_label.Location = Point(20, 340)\r\n        self.error_label.Size = Size(300, 30)\r\n        self.error_label.ForeColor = Color.Red\r\n        self.Controls.Add(self.error_label)\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto correspondente à opção escolhida será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "5d0e1e2da9544ab09441c444744a8eb6",
      "Inputs": [
        {
          "Id": "7234c24e291c478e9bf2f5d5bbc6ba4d",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "d916b02720dc4dad885c26a6d0733436",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "#TEMPLATE Python Script by BIM Coder\r\n#Versão 1.0 - 08/24\r\n\r\n#---IMPORTAÇÕES\r\n# Sistema e .NET\r\nimport clr\r\nimport sys\r\nimport System\r\nfrom System import Array\r\nfrom System.Collections.Generic import *\r\n\r\n# Biblioteca de Geometria do Dynamo\r\nclr.AddReference('ProtoGeometry')\r\nfrom Autodesk.DesignScript.Geometry import *\r\n\r\n# Nós do Dynamo\r\nclr.AddReference('RevitNodes')\r\nimport Revit\r\nclr.ImportExtensions(Revit.Elements)\r\nclr.ImportExtensions(Revit.GeometryConversion)\r\n\r\n# Documentos e Transações\r\nclr.AddReference('RevitServices')\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n# DB da API do Revit\r\nimport Autodesk\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Interface do usuário da API do Revit\r\nclr.AddReference('RevitAPIUI')\r\nfrom Autodesk.Revit.UI import *\r\n\r\nfrom Autodesk.Revit.UI.Selection import ObjectType\r\n\r\n# Documentos e Interfaces\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\nuiapp = DocumentManager.Instance.CurrentUIApplication\r\napp = uiapp.Application\r\nuidoc = uiapp.ActiveUIDocument\r\n\r\n#---CLASSES E FUNÇÕES\r\n\r\n#---SCRIPT\r\n\r\n# Solicitar ao usuário que selecione múltiplos objetos do tipo Element (por exemplo, paredes, janelas, etc.)\r\n\r\nselected_references = uidoc.Selection.PickObjects(ObjectType.Element)\r\n\r\n# Obter os elementos a partir das referências\r\nselected_elements = [uidoc.Document.GetElement(reference) for reference in selected_references]\r\n\r\n# Saída para o Dynamo (lista de elementos Revit)\r\nOUT = selected_elements\r\n\r\n\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "0ac5bc5c1f2b47b189557bbccfd24cf6",
      "Inputs": [
        {
          "Id": "de53f08c8f794514863a9df562df545d",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "34a7a1862e4d4481a37e1dc4f2a7bedf",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "#TEMPLATE Python Script by BIM Coder\r\n#Versão 1.0 - 08/24\r\n\r\n#---IMPORTAÇÕES\r\n# Sistema e .NET\r\nimport clr\r\nimport sys\r\nimport System\r\nfrom System import Array\r\nfrom System.Collections.Generic import *\r\n\r\n# Biblioteca de Geometria do Dynamo\r\nclr.AddReference('ProtoGeometry')\r\nfrom Autodesk.DesignScript.Geometry import *\r\n\r\n# Nós do Dynamo\r\nclr.AddReference('RevitNodes')\r\nimport Revit\r\nclr.ImportExtensions(Revit.Elements)\r\nclr.ImportExtensions(Revit.GeometryConversion)\r\n\r\n# Documentos e Transações\r\nclr.AddReference('RevitServices')\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n# DB da API do Revit\r\nimport Autodesk\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Interface do usuário da API do Revit\r\nclr.AddReference('RevitAPIUI')\r\nfrom Autodesk.Revit.UI import *\r\n\r\nfrom Autodesk.Revit.UI.Selection import ObjectType\r\n\r\n# Documentos e Interfaces\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\nuiapp = DocumentManager.Instance.CurrentUIApplication\r\napp = uiapp.Application\r\nuidoc = uiapp.ActiveUIDocument\r\n\r\n#---CLASSES E FUNÇÕES\r\n\r\n#---SCRIPT\r\n\r\n# Solicitar ao usuário que selecione múltiplos objetos do tipo Element (por exemplo, paredes, janelas, etc.)\r\n\r\nselected_references = uidoc.Selection.PickObjects(ObjectType.Element)\r\n\r\n# Obter os elementos a partir das referências\r\nselected_elements = [uidoc.Document.GetElement(reference) for reference in selected_references]\r\n\r\n# Saída para o Dynamo (lista de elementos Revit)\r\nOUT = selected_elements\r\n\r\n\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "6c3884ce02a647a0b9893129f30857bd",
      "Inputs": [
        {
          "Id": "0e5e6f42aff444c18b80abf0c73926b0",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "0e18a83cd5b34d59b0758524a60415da",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nfrom RevitServices.Persistence import DocumentManager\r\n\r\nclr.AddReference(\"RevitAPI\")\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Função para listar os elementos principais e suas famílias aninhadas\r\ndef get_all_elements(element, collected_ids):\r\n    element_list = []\r\n    \r\n    # Verificar se o elemento é uma instância de família ou um elemento de sistema (como Pipe)\r\n    if isinstance(element, (FamilyInstance, Pipe, Duct, CableTray, Conduit)):\r\n        # Adicionar o elemento principal à lista, se ainda não foi adicionado\r\n        if element.Id not in collected_ids:\r\n            element_list.append(element)\r\n            collected_ids.add(element.Id)\r\n        \r\n        # Verificar se o elemento tem famílias aninhadas (se aplicável)\r\n        if isinstance(element, FamilyInstance):\r\n            sub_elements = element.GetSubComponentIds()\r\n            if not sub_elements:\r\n                return element_list\r\n            \r\n            # Se o elemento tiver subcomponentes, adicionar os aninhados\r\n            for sub_elem_id in sub_elements:\r\n                sub_elem = doc.GetElement(sub_elem_id)\r\n                if isinstance(sub_elem, FamilyInstance) and sub_elem.Id not in collected_ids:\r\n                    element_list.append(sub_elem)\r\n                    collected_ids.add(sub_elem.Id)\r\n                    # Recursivamente buscar subcomponentes dos aninhados\r\n                    element_list.extend(get_all_elements(sub_elem, collected_ids))\r\n    return element_list\r\n\r\n# Coletando o documento ativo\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Entrada 0 - elementos selecionados\r\ninput_elements = UnwrapElement(IN[0])\r\n\r\n# Inicializando a lista de todos os elementos (principais e aninhados)\r\nall_elements = []\r\n\r\n# Inicializando um conjunto para evitar duplicatas com base no ID dos elementos\r\ncollected_ids = set()\r\n\r\n# Verificando todos os elementos e suas famílias aninhadas\r\nfor element in input_elements:\r\n    all_elements.extend(get_all_elements(element, collected_ids))\r\n\r\n# Saída - lista de todos os elementos, incluindo principais e aninhados\r\nOUT = all_elements\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "380bd58b3ff04405a1415e5d16183997",
      "Inputs": [
        {
          "Id": "2c010ffb5a66453e81002b1d6145ee57",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "2069d8c1543542b19752d3d7a1671fb7",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(350, 400)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.error_label = None  # Inicializando a variável para o erro\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label com as opções e o campo de entrada de texto.\"\"\"\r\n        lbl_options = Label()\r\n        lbl_options.Text = (\r\n            \"\\nEscolha uma opção:\\n\\n\"\r\n            \"1 - AUTOMACAO\\n2 - CABEAMENTO ESTRUTURADO\\n3 - CFTV\\n4 - COMUNICACAO VISUAL\\n\"\r\n            \"5 - DRENAGEM PLUVIAL\\n6 - ELETRICO\\n7 - EST. CONCRETO\\n8 - EST. METALICA\\n\"\r\n            \"9 - GASES MEDICINAIS\\n10 - GLP\\n11 - HIDROSSANITARIO\\n12 - INCENDIO\\n\"\r\n            \"13 - LUMINOTECNICO\\n14 - SDAI\\n15 - SPDA\"\r\n        )\r\n        lbl_options.Location = Point(20, 20)\r\n        lbl_options.Size = Size(300, 220)\r\n        lbl_options.AutoSize = True\r\n        self.Controls.Add(lbl_options)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 250)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 300)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        options = {\r\n            1: \"AUTOMACAO\",\r\n            2: \"CABEAMENTO ESTRUTURADO\",\r\n            3: \"CFTV\",\r\n            4: \"COMUNICACAO VISUAL\",\r\n            5: \"DRENAGEM PLUVIAL\",\r\n            6: \"ELETRICO\",\r\n            7: \"EST. CONCRETO\",\r\n            8: \"EST. METALICA\",\r\n            9: \"GASES MEDICINAIS\",\r\n            10: \"GLP\",\r\n            11: \"HIDROSSANITARIO\",\r\n            12: \"INCENDIO\",\r\n            13: \"LUMINOTECNICO\",\r\n            14: \"SDAI\",\r\n            15: \"SPDA\"\r\n        }\r\n\r\n        try:\r\n            # Remove a mensagem de erro anterior, se existir\r\n            if self.error_label:\r\n                self.Controls.Remove(self.error_label)\r\n\r\n            input_value = int(self.txt_input.Text)\r\n            if input_value in options:\r\n                self.user_input = options[input_value]\r\n            else:\r\n                self.user_input = None\r\n                self.show_error(\"Por favor, escolha uma opção válida (1-15).\")\r\n        except ValueError:\r\n            self.user_input = None\r\n            self.show_error(\"Por favor, insira um número válido.\")\r\n\r\n        if self.user_input is not None:\r\n            self.Close()\r\n\r\n    def show_error(self, message):\r\n        \"\"\"Exibe uma mensagem de erro.\"\"\"\r\n        self.error_label = Label()\r\n        self.error_label.Text = message\r\n        self.error_label.Location = Point(20, 340)\r\n        self.error_label.Size = Size(300, 30)\r\n        self.error_label.ForeColor = Color.Red\r\n        self.Controls.Add(self.error_label)\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto correspondente à opção escolhida será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "dd1fb73d0dab444fbb533ae5074646d3",
      "Inputs": [
        {
          "Id": "b56c00b138214f76bac55dfa11fb4f6b",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "cf5c7bf326644b3c99710e2907333059",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitAPIUI')\r\n\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\nfrom Autodesk.Revit.DB import Element\r\n\r\n# Obter o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obter os elementos selecionados a partir de IN[0] e o texto da IN[1]\r\nelements = UnwrapElement(IN[0])  # Desembrulha os elementos do Dynamo\r\ntext_to_set = IN[1]  # Texto a ser inserido no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\n\r\n# Iniciar uma transação para modificar os parâmetros no Revit\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n\r\n# Iterar sobre os elementos e definir o valor no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\nfor element in elements:\r\n    marca_param = element.LookupParameter(\"ORÇAMENTO TIPO DE SISTEMA\")\r\n    if marca_param and not marca_param.IsReadOnly:\r\n        marca_param.Set(text_to_set)\r\n\r\n# Finalizar a transação\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\n# Saída\r\nOUT = \"Texto atualizado no parâmetro 'ORÇAMENTO TIPO DE SISTEMA' para {} elementos.\".format(len(elements))\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "b5997983de0a4a60a523c46b7506e994",
      "Inputs": [
        {
          "Id": "4a28b8aaa20c4b84a4dc710067621961",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "fbc993f981734d7b9200bd8c625e6f75",
          "Name": "IN[1]",
          "Description": "Input #1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "27db5e7996e745a59d755955d9741edf",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "#TEMPLATE Python Script by BIM Coder\r\n#Versão 1.0 - 08/24\r\n\r\n#---IMPORTAÇÕES\r\n# Sistema e .NET\r\nimport clr\r\nimport sys\r\nimport System\r\nfrom System import Array\r\nfrom System.Collections.Generic import *\r\n\r\n# Biblioteca de Geometria do Dynamo\r\nclr.AddReference('ProtoGeometry')\r\nfrom Autodesk.DesignScript.Geometry import *\r\n\r\n# Nós do Dynamo\r\nclr.AddReference('RevitNodes')\r\nimport Revit\r\nclr.ImportExtensions(Revit.Elements)\r\nclr.ImportExtensions(Revit.GeometryConversion)\r\n\r\n# Documentos e Transações\r\nclr.AddReference('RevitServices')\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n# DB da API do Revit\r\nimport Autodesk\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Interface do usuário da API do Revit\r\nclr.AddReference('RevitAPIUI')\r\nfrom Autodesk.Revit.UI import *\r\n\r\nfrom Autodesk.Revit.UI.Selection import ObjectType\r\n\r\n# Documentos e Interfaces\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\nuiapp = DocumentManager.Instance.CurrentUIApplication\r\napp = uiapp.Application\r\nuidoc = uiapp.ActiveUIDocument\r\n\r\n#---CLASSES E FUNÇÕES\r\n\r\n#---SCRIPT\r\n\r\n# Solicitar ao usuário que selecione múltiplos objetos do tipo Element (por exemplo, paredes, janelas, etc.)\r\n\r\nselected_references = uidoc.Selection.PickObjects(ObjectType.Element)\r\n\r\n# Obter os elementos a partir das referências\r\nselected_elements = [uidoc.Document.GetElement(reference) for reference in selected_references]\r\n\r\n# Saída para o Dynamo (lista de elementos Revit)\r\nOUT = selected_elements\r\n\r\n\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "7ad6fc2c71274196bd8a299d5b45fc96",
      "Inputs": [
        {
          "Id": "ec9e7934848c49d1b7d7c66690fb43ad",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "61694c82532746d1b960a9af0f6ab62b",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nfrom RevitServices.Persistence import DocumentManager\r\n\r\nclr.AddReference(\"RevitAPI\")\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Função para listar os elementos principais e suas famílias aninhadas\r\ndef get_all_elements(element, collected_ids):\r\n    element_list = []\r\n    \r\n    # Verificar se o elemento é uma instância de família ou um elemento de sistema (como Pipe)\r\n    if isinstance(element, Element):  # Usando Element como verificação genérica\r\n        # Adicionar o elemento principal à lista, se ainda não foi adicionado\r\n        if element.Id not in collected_ids:\r\n            element_list.append(element)\r\n            collected_ids.add(element.Id)\r\n        \r\n        # Se o elemento for uma FamilyInstance, verificar subcomponentes\r\n        if isinstance(element, FamilyInstance):\r\n            sub_elements = element.GetSubComponentIds()\r\n            if not sub_elements:\r\n                return element_list\r\n            \r\n            # Se o elemento tiver subcomponentes, adicionar os aninhados\r\n            for sub_elem_id in sub_elements:\r\n                sub_elem = doc.GetElement(sub_elem_id)\r\n                if isinstance(sub_elem, FamilyInstance) and sub_elem.Id not in collected_ids:\r\n                    element_list.append(sub_elem)\r\n                    collected_ids.add(sub_elem.Id)\r\n                    # Recursivamente buscar subcomponentes dos aninhados\r\n                    element_list.extend(get_all_elements(sub_elem, collected_ids))\r\n    \r\n    return element_list\r\n\r\n# Coletando o documento ativo\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Entrada 0 - elementos selecionados\r\ninput_elements = UnwrapElement(IN[0])\r\n\r\n# Inicializando a lista de todos os elementos (principais e aninhados)\r\nall_elements = []\r\n\r\n# Inicializando um conjunto para evitar duplicatas com base no ID dos elementos\r\ncollected_ids = set()\r\n\r\n# Verificando todos os elementos e suas famílias aninhadas\r\nfor element in input_elements:\r\n    if isinstance(element, Element):  # Verificação genérica de que o objeto é um elemento do Revit\r\n        all_elements.extend(get_all_elements(element, collected_ids))\r\n\r\n# Saída - lista de todos os elementos, incluindo principais e aninhados\r\nOUT = all_elements\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "d80239c3a539496c930b5ff57a1cdcbc",
      "Inputs": [
        {
          "Id": "fe72ba40ef8c429998205628d8e34ee2",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "7f417fc113dd4002abed1f8224cb244c",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(350, 400)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.error_label = None  # Inicializando a variável para o erro\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label com as opções e o campo de entrada de texto.\"\"\"\r\n        lbl_options = Label()\r\n        lbl_options.Text = (\r\n            \"\\nEscolha uma opção:\\n\\n\"\r\n            \"1 - AUTOMACAO\\n2 - CABEAMENTO ESTRUTURADO\\n3 - CFTV\\n4 - COMUNICACAO VISUAL\\n\"\r\n            \"5 - DRENAGEM PLUVIAL\\n6 - ELETRICO\\n7 - EST. CONCRETO\\n8 - EST. METALICA\\n\"\r\n            \"9 - GASES MEDICINAIS\\n10 - GLP\\n11 - HIDROSSANITARIO\\n12 - INCENDIO\\n\"\r\n            \"13 - LUMINOTECNICO\\n14 - SDAI\\n15 - SPDA\"\r\n        )\r\n        lbl_options.Location = Point(20, 20)\r\n        lbl_options.Size = Size(300, 220)\r\n        lbl_options.AutoSize = True\r\n        self.Controls.Add(lbl_options)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 250)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 300)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        options = {\r\n            1: \"AUTOMACAO\",\r\n            2: \"CABEAMENTO ESTRUTURADO\",\r\n            3: \"CFTV\",\r\n            4: \"COMUNICACAO VISUAL\",\r\n            5: \"DRENAGEM PLUVIAL\",\r\n            6: \"ELETRICO\",\r\n            7: \"EST. CONCRETO\",\r\n            8: \"EST. METALICA\",\r\n            9: \"GASES MEDICINAIS\",\r\n            10: \"GLP\",\r\n            11: \"HIDROSSANITARIO\",\r\n            12: \"INCENDIO\",\r\n            13: \"LUMINOTECNICO\",\r\n            14: \"SDAI\",\r\n            15: \"SPDA\"\r\n        }\r\n\r\n        try:\r\n            # Remove a mensagem de erro anterior, se existir\r\n            if self.error_label:\r\n                self.Controls.Remove(self.error_label)\r\n\r\n            input_value = int(self.txt_input.Text)\r\n            if input_value in options:\r\n                self.user_input = options[input_value]\r\n            else:\r\n                self.user_input = None\r\n                self.show_error(\"Por favor, escolha uma opção válida (1-15).\")\r\n        except ValueError:\r\n            self.user_input = None\r\n            self.show_error(\"Por favor, insira um número válido.\")\r\n\r\n        if self.user_input is not None:\r\n            self.Close()\r\n\r\n    def show_error(self, message):\r\n        \"\"\"Exibe uma mensagem de erro.\"\"\"\r\n        self.error_label = Label()\r\n        self.error_label.Text = message\r\n        self.error_label.Location = Point(20, 340)\r\n        self.error_label.Size = Size(300, 30)\r\n        self.error_label.ForeColor = Color.Red\r\n        self.Controls.Add(self.error_label)\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto correspondente à opção escolhida será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "8f0acbea7585435083b88ecaf9859ab2",
      "Inputs": [
        {
          "Id": "a192d86859f74782b3777fdb390b1670",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "9aa072525c7f455faad99e2a21e4d8b3",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitAPIUI')\r\n\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\nfrom Autodesk.Revit.DB import Element\r\n\r\n# Obter o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obter os elementos selecionados a partir de IN[0] e o texto da IN[1]\r\nelements = UnwrapElement(IN[0])  # Desembrulha os elementos do Dynamo\r\ntext_to_set = IN[1]  # Texto a ser inserido no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\n\r\n# Iniciar uma transação para modificar os parâmetros no Revit\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n\r\n# Iterar sobre os elementos e definir o valor no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\nfor element in elements:\r\n    marca_param = element.LookupParameter(\"ORÇAMENTO TIPO DE SISTEMA\")\r\n    if marca_param and not marca_param.IsReadOnly:\r\n        marca_param.Set(text_to_set)\r\n\r\n# Finalizar a transação\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\n# Saída\r\nOUT = \"Texto atualizado no parâmetro 'ORÇAMENTO TIPO DE SISTEMA' para {} elementos.\".format(len(elements))\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "2d3b295c033540dca41dcea294570619",
      "Inputs": [
        {
          "Id": "69fadfe191164e98ad508cb9d018f5f7",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "0aef03d1018e4a108e0a679b4752aea9",
          "Name": "IN[1]",
          "Description": "Input #1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "50d24668c2d6411f87fe46c68c68c2db",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "#TEMPLATE Python Script by BIM Coder\r\n#Versão 1.0 - 08/24\r\n\r\n#---IMPORTAÇÕES\r\n# Sistema e .NET\r\nimport clr\r\nimport sys\r\nimport System\r\nfrom System import Array\r\nfrom System.Collections.Generic import *\r\n\r\n# Biblioteca de Geometria do Dynamo\r\nclr.AddReference('ProtoGeometry')\r\nfrom Autodesk.DesignScript.Geometry import *\r\n\r\n# Nós do Dynamo\r\nclr.AddReference('RevitNodes')\r\nimport Revit\r\nclr.ImportExtensions(Revit.Elements)\r\nclr.ImportExtensions(Revit.GeometryConversion)\r\n\r\n# Documentos e Transações\r\nclr.AddReference('RevitServices')\r\nimport RevitServices\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\n\r\n# DB da API do Revit\r\nimport Autodesk\r\nclr.AddReference('RevitAPI')\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Interface do usuário da API do Revit\r\nclr.AddReference('RevitAPIUI')\r\nfrom Autodesk.Revit.UI import *\r\n\r\nfrom Autodesk.Revit.UI.Selection import ObjectType\r\n\r\n# Documentos e Interfaces\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\nuiapp = DocumentManager.Instance.CurrentUIApplication\r\napp = uiapp.Application\r\nuidoc = uiapp.ActiveUIDocument\r\n\r\n#---CLASSES E FUNÇÕES\r\n\r\n#---SCRIPT\r\n\r\n# Solicitar ao usuário que selecione múltiplos objetos do tipo Element (por exemplo, paredes, janelas, etc.)\r\n\r\nselected_references = uidoc.Selection.PickObjects(ObjectType.Element)\r\n\r\n# Obter os elementos a partir das referências\r\nselected_elements = [uidoc.Document.GetElement(reference) for reference in selected_references]\r\n\r\n# Saída para o Dynamo (lista de elementos Revit)\r\nOUT = selected_elements\r\n\r\n\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "4eaa3ad16f21426c932dcc71206b1eb5",
      "Inputs": [
        {
          "Id": "ba0cb73e74a04451b0fa6111791de507",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "5321adc035d94253ab087d70013bdf62",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nfrom RevitServices.Persistence import DocumentManager\r\n\r\nclr.AddReference(\"RevitAPI\")\r\nfrom Autodesk.Revit.DB import *\r\n\r\n# Função para listar os elementos principais e suas famílias aninhadas\r\ndef get_all_elements(element, collected_ids):\r\n    element_list = []\r\n    \r\n    # Verificar se o elemento é uma instância de família ou um elemento de sistema (como Pipe)\r\n    if isinstance(element, Element):  # Usando Element como verificação genérica\r\n        # Adicionar o elemento principal à lista, se ainda não foi adicionado\r\n        if element.Id not in collected_ids:\r\n            element_list.append(element)\r\n            collected_ids.add(element.Id)\r\n        \r\n        # Se o elemento for uma FamilyInstance, verificar subcomponentes\r\n        if isinstance(element, FamilyInstance):\r\n            sub_elements = element.GetSubComponentIds()\r\n            if not sub_elements:\r\n                return element_list\r\n            \r\n            # Se o elemento tiver subcomponentes, adicionar os aninhados\r\n            for sub_elem_id in sub_elements:\r\n                sub_elem = doc.GetElement(sub_elem_id)\r\n                if isinstance(sub_elem, FamilyInstance) and sub_elem.Id not in collected_ids:\r\n                    element_list.append(sub_elem)\r\n                    collected_ids.add(sub_elem.Id)\r\n                    # Recursivamente buscar subcomponentes dos aninhados\r\n                    element_list.extend(get_all_elements(sub_elem, collected_ids))\r\n    \r\n    return element_list\r\n\r\n# Coletando o documento ativo\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Entrada 0 - elementos selecionados\r\ninput_elements = UnwrapElement(IN[0])\r\n\r\n# Inicializando a lista de todos os elementos (principais e aninhados)\r\nall_elements = []\r\n\r\n# Inicializando um conjunto para evitar duplicatas com base no ID dos elementos\r\ncollected_ids = set()\r\n\r\n# Verificando todos os elementos e suas famílias aninhadas\r\nfor element in input_elements:\r\n    if isinstance(element, Element):  # Verificação genérica de que o objeto é um elemento do Revit\r\n        all_elements.extend(get_all_elements(element, collected_ids))\r\n\r\n# Saída - lista de todos os elementos, incluindo principais e aninhados\r\nOUT = all_elements\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "8e368a6d11a54b479635603f3e874ef3",
      "Inputs": [
        {
          "Id": "f49dc41402f04588b5c4c64fc601c4ce",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "b81f5860770c48d7ae9a7d81c006ea89",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('System.Windows.Forms')\r\nclr.AddReference('System.Drawing')\r\n\r\nfrom System.Windows.Forms import Application, Form, Label, TextBox, Button, FormStartPosition\r\nfrom System.Drawing import Point, Size, Color\r\n\r\nclass MyForm(Form):\r\n    def __init__(self, theme='Dark'):\r\n        # Configurações do Formulário\r\n        self.Text = \"Parâmetro ORÇAMENTO TIPO DE SISTEMA\"\r\n        self.Size = Size(300, 260)\r\n        self.StartPosition = FormStartPosition.CenterScreen\r\n        self.ShowIcon = False\r\n        self.MaximizeBox = False\r\n        self.MinimizeBox = False\r\n\r\n        # Configuração do tema\r\n        if theme == 'Light':\r\n            self.BackColor = Color.White\r\n            self.ForeColor = Color.Black\r\n        else:\r\n            self.BackColor = Color.FromArgb(45, 45, 48)  # Dark theme\r\n            self.ForeColor = Color.White\r\n\r\n        self.error_label = None  # Inicializando a variável para o erro\r\n        self.create_form()\r\n        self.create_ok_button()\r\n\r\n    def create_form(self):\r\n        \"\"\"Cria a Label com as opções e o campo de entrada de texto.\"\"\"\r\n        lbl_options = Label()\r\n        lbl_options.Text = (\r\n            \"\\nEscolha uma opção:\\n\\n\"\r\n            \"1 - AGUA FRIA\\n2 - AGUA QUENTE\\n3 - DRENAGEM\\n4 - ESGOTO SANITARIO\"\r\n        )\r\n        lbl_options.Location = Point(20, 20)\r\n        lbl_options.Size = Size(300, 220)\r\n        lbl_options.AutoSize = True\r\n        self.Controls.Add(lbl_options)\r\n\r\n        self.txt_input = TextBox()\r\n        self.txt_input.Location = Point(20, 130)\r\n        self.txt_input.Size = Size(240, 30)\r\n        self.Controls.Add(self.txt_input)\r\n\r\n    def create_ok_button(self):\r\n        \"\"\"Cria o botão OK para capturar o texto e fechar o formulário.\"\"\"\r\n        btn_ok = Button()\r\n        btn_ok.Text = \"OK\"\r\n        btn_ok.Location = Point((self.ClientSize.Width - 100) // 2, 160)\r\n        btn_ok.Size = Size(100, 30)\r\n        btn_ok.Click += self.on_ok\r\n        self.Controls.Add(btn_ok)\r\n\r\n    def on_ok(self, sender, event):\r\n        \"\"\"Captura o texto digitado e fecha o formulário.\"\"\"\r\n        options = {\r\n            1: \"AGUA FRIA\",\r\n            2: \"AGUA QUENTE\",\r\n            3: \"DRENAGEM\",\r\n            4: \"ESGOTO SANITARIO\"\r\n        }\r\n\r\n        try:\r\n            # Remove a mensagem de erro anterior, se existir\r\n            if self.error_label:\r\n                self.Controls.Remove(self.error_label)\r\n\r\n            input_value = int(self.txt_input.Text)\r\n            if input_value in options:\r\n                self.user_input = options[input_value]\r\n            else:\r\n                self.user_input = None\r\n                self.show_error(\"Por favor, escolha uma opção válida (1-4).\")\r\n        except ValueError:\r\n            self.user_input = None\r\n            self.show_error(\"Por favor, insira um número válido.\")\r\n\r\n        if self.user_input is not None:\r\n            self.Close()\r\n\r\n    def show_error(self, message):\r\n        \"\"\"Exibe uma mensagem de erro.\"\"\"\r\n        self.error_label = Label()\r\n        self.error_label.Text = message\r\n        self.error_label.Location = Point(20, 200)\r\n        self.error_label.Size = Size(300, 30)\r\n        self.error_label.ForeColor = Color.Red\r\n        self.Controls.Add(self.error_label)\r\n\r\n# Criação do formulário\r\ntheme = \"Dark\"  # Você pode mudar para \"Light\" se quiser o tema claro\r\nform = MyForm(theme)\r\nApplication.Run(form)\r\n\r\n# O texto correspondente à opção escolhida será armazenado na variável 'form.user_input'\r\nOUT = form.user_input\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "74e042eacba44335b9b5dc78ed0b2908",
      "Inputs": [
        {
          "Id": "af269722dcb84fb28361e8918d146411",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "301fbe01050348c595362cb887355491",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    },
    {
      "ConcreteType": "PythonNodeModels.PythonNode, PythonNodeModels",
      "NodeType": "PythonScriptNode",
      "Code": "import clr\r\nclr.AddReference('RevitServices')\r\nclr.AddReference('RevitAPI')\r\nclr.AddReference('RevitAPIUI')\r\n\r\nfrom RevitServices.Persistence import DocumentManager\r\nfrom RevitServices.Transactions import TransactionManager\r\nfrom Autodesk.Revit.DB import Element\r\n\r\n# Obter o documento ativo do Revit\r\ndoc = DocumentManager.Instance.CurrentDBDocument\r\n\r\n# Obter os elementos selecionados a partir de IN[0] e o texto da IN[1]\r\nelements = UnwrapElement(IN[0])  # Desembrulha os elementos do Dynamo\r\ntext_to_set = IN[1]  # Texto a ser inserido no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\n\r\n# Iniciar uma transação para modificar os parâmetros no Revit\r\nTransactionManager.Instance.EnsureInTransaction(doc)\r\n\r\n# Iterar sobre os elementos e definir o valor no parâmetro \"ORÇAMENTO TIPO DE SISTEMA\"\r\nfor element in elements:\r\n    marca_param = element.LookupParameter(\"ORÇAMENTO TIPO DE SISTEMA\")\r\n    if marca_param and not marca_param.IsReadOnly:\r\n        marca_param.Set(text_to_set)\r\n\r\n# Finalizar a transação\r\nTransactionManager.Instance.TransactionTaskDone()\r\n\r\n# Saída\r\nOUT = \"Texto atualizado no parâmetro 'ORÇAMENTO TIPO DE SISTEMA' para {} elementos.\".format(len(elements))\r\n",
      "Engine": "IronPython2",
      "VariableInputPorts": true,
      "Id": "0d0107d0cd804b1ea155313c4a01499b",
      "Inputs": [
        {
          "Id": "6569383a9b054e3783385b6cf8b2409f",
          "Name": "IN[0]",
          "Description": "Input #0",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        },
        {
          "Id": "dda440d6c49146c89560f4d4fb8f2388",
          "Name": "IN[1]",
          "Description": "Input #1",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Outputs": [
        {
          "Id": "423c4dc5e468410881b7b4121ae208c1",
          "Name": "OUT",
          "Description": "Resultado do script Python",
          "UsingDefaultValue": false,
          "Level": 2,
          "UseLevels": false,
          "KeepListStructure": false
        }
      ],
      "Replication": "Disabled",
      "Description": "Executa um script Python incorporado."
    }
  ],
  "Connectors": [
    {
      "Start": "6f80c559d8a14db0afbb440437ab7c00",
      "End": "e32677c97c1c47e09f81e51f3f124f1b",
      "Id": "b0d432ea37b043d4a240ca69bf65eab7",
      "IsHidden": "False"
    },
    {
      "Start": "4bff9b097fe342b28ceb5b64e6a74e97",
      "End": "f985f7c0aea04532a77187aef1f57926",
      "Id": "1d2f905a9c58420697450321c47582ba",
      "IsHidden": "False"
    },
    {
      "Start": "4bff9b097fe342b28ceb5b64e6a74e97",
      "End": "5920796a09bc4e1baffec63d78e89a6e",
      "Id": "dc94f544ddcb4425864951ce907a27af",
      "IsHidden": "False"
    },
    {
      "Start": "859ba656cab84e78955ecb21f175d0b8",
      "End": "68ca7090cccb4d3ebed9727d176d718c",
      "Id": "8c6390da31b343038da252688ec3d2b0",
      "IsHidden": "False"
    },
    {
      "Start": "c729917f78ce4d4aa11e38b16b6dfed1",
      "End": "1d4f31e99c83431da71f560c95dd7605",
      "Id": "c94392997f0442659f86c2d0f0883f1d",
      "IsHidden": "False"
    },
    {
      "Start": "c729917f78ce4d4aa11e38b16b6dfed1",
      "End": "0623b13038a54454b2314050277714a2",
      "Id": "fa9dc66645e24325a40213dd91f4936c",
      "IsHidden": "False"
    },
    {
      "Start": "7e7bb640c7a74fc7938cf5943284294e",
      "End": "7671e771694d4ae2b6b0e863dabcf6d5",
      "Id": "a05ee4f6cf5343978c5b5060444b5f12",
      "IsHidden": "False"
    },
    {
      "Start": "bbb3f6ad9b5e4c2a8f925b1ce124f172",
      "End": "44d7424967db4458a973a1bf53e169f7",
      "Id": "f2030e4a08a54ed6b2edd723207f03ea",
      "IsHidden": "False"
    },
    {
      "Start": "badef45b55b74bb6bd320f2129df1acd",
      "End": "f078435f0a724f78b5c62291dd5d621b",
      "Id": "1ae05de1424d4bde92d95a521997e9cd",
      "IsHidden": "False"
    },
    {
      "Start": "badef45b55b74bb6bd320f2129df1acd",
      "End": "f7a46fe9b92e4a82bcfc6f69658040dd",
      "Id": "3f9baf907a5e463ca31fa361baa63bd2",
      "IsHidden": "False"
    },
    {
      "Start": "3f2d8c10eae04060b8a38ae50f89d7b1",
      "End": "50ae05641394474e889a8d6e670cc603",
      "Id": "11cb9968ba8541419bf641fbd2137c38",
      "IsHidden": "False"
    },
    {
      "Start": "327b32b1da344a669f8d0bf63fcf0b15",
      "End": "24f67f2236b84ad9b461c73e75d67382",
      "Id": "5cee8686c80d4ae7937c951739513c37",
      "IsHidden": "False"
    },
    {
      "Start": "a0265fe57f8c4f1db90f94cd257abe5c",
      "End": "1460db53475148cc821b476055eb3231",
      "Id": "615b54070f4743fc970f88a65f4259e7",
      "IsHidden": "False"
    },
    {
      "Start": "65ae40241eeb4a998e2cea11c9f4e390",
      "End": "049c101829244e05843d0b2d61749aad",
      "Id": "79d0b188f01c4e5c875ed4a4eda852e2",
      "IsHidden": "False"
    },
    {
      "Start": "d916b02720dc4dad885c26a6d0733436",
      "End": "cea620087db6496597303dd418ad0822",
      "Id": "2da7e07658824e38a06bfe54a5cc656d",
      "IsHidden": "False"
    },
    {
      "Start": "34a7a1862e4d4481a37e1dc4f2a7bedf",
      "End": "1d580ead64394ff8be9275b0f755b71b",
      "Id": "304f64dad68c463fbabf710147cbf329",
      "IsHidden": "False"
    },
    {
      "Start": "0e18a83cd5b34d59b0758524a60415da",
      "End": "2c010ffb5a66453e81002b1d6145ee57",
      "Id": "045c2d660ff54e4cb318bd843aedbdc9",
      "IsHidden": "False"
    },
    {
      "Start": "2069d8c1543542b19752d3d7a1671fb7",
      "End": "4a28b8aaa20c4b84a4dc710067621961",
      "Id": "7a56382d68ae4793be3e3e7916b70468",
      "IsHidden": "False"
    },
    {
      "Start": "cf5c7bf326644b3c99710e2907333059",
      "End": "fbc993f981734d7b9200bd8c625e6f75",
      "Id": "34ad274c727a4d6e94345896b9b84ba0",
      "IsHidden": "False"
    },
    {
      "Start": "61694c82532746d1b960a9af0f6ab62b",
      "End": "fe72ba40ef8c429998205628d8e34ee2",
      "Id": "2e3ef2f4657b47a2a4586f43e8a576ea",
      "IsHidden": "False"
    },
    {
      "Start": "7f417fc113dd4002abed1f8224cb244c",
      "End": "69fadfe191164e98ad508cb9d018f5f7",
      "Id": "6a7e7cb8a7464ff6aea4d43b0b4810f2",
      "IsHidden": "False"
    },
    {
      "Start": "9aa072525c7f455faad99e2a21e4d8b3",
      "End": "0aef03d1018e4a108e0a679b4752aea9",
      "Id": "efe32aa6092d40d69405ec473d4906ea",
      "IsHidden": "False"
    },
    {
      "Start": "5321adc035d94253ab087d70013bdf62",
      "End": "f49dc41402f04588b5c4c64fc601c4ce",
      "Id": "9acd56de905a48fb8a300200b4cc0971",
      "IsHidden": "False"
    },
    {
      "Start": "b81f5860770c48d7ae9a7d81c006ea89",
      "End": "6569383a9b054e3783385b6cf8b2409f",
      "Id": "96414bb63daa4cb7a7e18542c09523c7",
      "IsHidden": "False"
    },
    {
      "Start": "301fbe01050348c595362cb887355491",
      "End": "dda440d6c49146c89560f4d4fb8f2388",
      "Id": "e7dbef27f7f4430ca456375a4c5c0a2d",
      "IsHidden": "False"
    }
  ],
  "Dependencies": [],
  "NodeLibraryDependencies": [],
  "Thumbnail": "",
  "GraphDocumentationURL": null,
  "ExtensionWorkspaceData": [
    {
      "ExtensionGuid": "28992e1d-abb9-417f-8b1b-05e053bee670",
      "Name": "Properties",
      "Version": "2.13",
      "Data": {}
    },
    {
      "ExtensionGuid": "DFBD9CC0-DB40-457A-939E-8C8555555A9D",
      "Name": "Generative Design",
      "Version": "2.0",
      "Data": {}
    }
  ],
  "Author": "",
  "Linting": {
    "activeLinter": "Nenhum",
    "activeLinterId": "7b75fb44-43fd-4631-a878-29f4d5d8399a",
    "warningCount": 0,
    "errorCount": 0
  },
  "Bindings": [],
  "View": {
    "Dynamo": {
      "ScaleFactor": 1.0,
      "HasRunWithoutCrash": true,
      "IsVisibleInDynamoLibrary": true,
      "Version": "2.13.1.3887",
      "RunType": "Manual",
      "RunPeriod": "1000"
    },
    "Camera": {
      "Name": "Visualização do plano de fundo",
      "EyeX": -17.0,
      "EyeY": 24.0,
      "EyeZ": 50.0,
      "LookX": 12.0,
      "LookY": -13.0,
      "LookZ": -58.0,
      "UpX": 0.0,
      "UpY": 1.0,
      "UpZ": 0.0
    },
    "ConnectorPins": [],
    "NodeViews": [
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "eed387aad76b45adbcde7db4be1589bd",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -423.26622688159989,
        "Y": 508.55905580445938
      },
      {
        "Name": "PREENCHER O PARAMETRO",
        "ShowGeometry": true,
        "Id": "499628238e654e7295272e757a058a3a",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 1771.4143077762083,
        "Y": 238.23340213371614
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "a03091fc7cfa4ed1a20db2c0357a8153",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": 67.790125127732949,
        "Y": 56.758913348149832
      },
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "ba0dba6294e84eebad133dd870a51acd",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": 1570.2395918415032,
        "Y": 458.99220837023347
      },
      {
        "Name": "Element.GetChildElements",
        "ShowGeometry": true,
        "Id": "f19c41c1ab1a456b97046a740ad6c843",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 16.469045808075293,
        "Y": 294.04208630022219
      },
      {
        "Name": "List Create",
        "ShowGeometry": true,
        "Id": "36f3a5371d6446fabfe32483ed043c6d",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 490.14642836697067,
        "Y": 157.13168695978578
      },
      {
        "Name": "List.Flatten",
        "ShowGeometry": true,
        "Id": "d537674ddf11492296d5f32255e94334",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 710.48291022008789,
        "Y": 257.550920562229
      },
      {
        "Name": "Object.IsNull",
        "ShowGeometry": true,
        "Id": "05909d0aae28499bbc6e072e0f67db03",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 938.33940081609342,
        "Y": 500.98136034735171
      },
      {
        "Name": "List.FilterByBoolMask",
        "ShowGeometry": true,
        "Id": "8a80f2a779584a0982412abc50372592",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 1147.0411155512568,
        "Y": 281.48144026604126
      },
      {
        "Name": "SELEÇÃO DOS ELEMENTOS",
        "ShowGeometry": true,
        "Id": "1804c1ab9eb44617b7e31e9346c64cf8",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -381.93160415993714,
        "Y": 287.38568893065525
      },
      {
        "Name": "List.Flatten",
        "ShowGeometry": true,
        "Id": "d2ab14e2a7604ec1975c6d36d5a08330",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -15.659947527554664,
        "Y": 643.82180211996774
      },
      {
        "Name": "Object.IsNull",
        "ShowGeometry": true,
        "Id": "876c460d8e4c496b9dcf1bc73d3f362c",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 242.36827138423143,
        "Y": 866.0663353545707
      },
      {
        "Name": "List.FilterByBoolMask",
        "ShowGeometry": true,
        "Id": "a3dcddeaf4914af9b1ffb707ac7e054c",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 451.06998611939832,
        "Y": 646.56641527325974
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "26d28fee827249d79275f3b82425a052",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -123.35111931125482,
        "Y": 2005.0617692733063
      },
      {
        "Name": "PREENCHER O PARAMETRO",
        "ShowGeometry": true,
        "Id": "1a7e7dc827e24ea19ad11078517ee2be",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 118.31711129931773,
        "Y": 2003.8119920831264
      },
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "5d0e1e2da9544ab09441c444744a8eb6",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -101.02537376514988,
        "Y": 2170.7720873103067
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "0ac5bc5c1f2b47b189557bbccfd24cf6",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -394.47273858660583,
        "Y": 2003.5612662365361
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "6c3884ce02a647a0b9893129f30857bd",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -400.75923228974506,
        "Y": 2386.3638379385711
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "380bd58b3ff04405a1415e5d16183997",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -129.63761301439405,
        "Y": 2387.8643409753413
      },
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "dd1fb73d0dab444fbb533ae5074646d3",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -107.31186746828905,
        "Y": 2553.5746590123408
      },
      {
        "Name": "PREENCHER O PARAMETRO",
        "ShowGeometry": true,
        "Id": "b5997983de0a4a60a523c46b7506e994",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 112.0306175961789,
        "Y": 2386.6145637851614
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "7ad6fc2c71274196bd8a299d5b45fc96",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -383.02004306172716,
        "Y": 2737.8807737496068
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "d80239c3a539496c930b5ff57a1cdcbc",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -111.89842378637616,
        "Y": 2739.3812767863765
      },
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "8f0acbea7585435083b88ecaf9859ab2",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": true,
        "X": -89.572678240271216,
        "Y": 2905.0915948233765
      },
      {
        "Name": "PREENCHER O PARAMETRO",
        "ShowGeometry": true,
        "Id": "2d3b295c033540dca41dcea294570619",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 129.76980682419685,
        "Y": 2738.1314995961966
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "4eaa3ad16f21426c932dcc71206b1eb5",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -388.26400846309781,
        "Y": 3853.788967018982
      },
      {
        "Name": "Python Script",
        "ShowGeometry": true,
        "Id": "8e368a6d11a54b479635603f3e874ef3",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -117.14238918774686,
        "Y": 3855.2894700557522
      },
      {
        "Name": "TEXTO",
        "ShowGeometry": true,
        "Id": "74e042eacba44335b9b5dc78ed0b2908",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": -94.8166436416418,
        "Y": 4020.9997880927522
      },
      {
        "Name": "PREENCHER O PARAMETRO",
        "ShowGeometry": true,
        "Id": "0d0107d0cd804b1ea155313c4a01499b",
        "IsSetAsInput": false,
        "IsSetAsOutput": false,
        "Excluded": false,
        "X": 124.52584142282615,
        "Y": 3854.0396928655723
      }
    ],
    "Annotations": [],
    "X": 286.34494399198695,
    "Y": -1767.1709503917018,
    "Zoom": 0.54833303733364436
  }
}